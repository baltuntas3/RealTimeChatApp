const {server, io} = require("../");

const port = process.env.PORT || 5000;

server.listen(port, () => {
    console.log(`üöÄ Server ${port} portunda ba≈ülatƒ±ldƒ±`);
    console.log(`üì° HTTP API: http://localhost:${port}`);
    console.log(`üîå WebSocket: ws://localhost:${port}`);
    console.log(`üì± Socket.io baƒülantƒ±sƒ± hazƒ±r`);
});

// Graceful shutdown
process.on("SIGTERM", () => {
    console.log("SIGTERM alƒ±ndƒ±, server kapatƒ±lƒ±yor...");
    server.close(() => {
        console.log("‚úÖ Server g√ºvenli ≈üekilde kapatƒ±ldƒ±");
        process.exit(0);
    });
});

process.on("SIGINT", () => {
    console.log("SIGINT alƒ±ndƒ±, server kapatƒ±lƒ±yor...");
    server.close(() => {
        console.log("‚úÖ Server g√ºvenli ≈üekilde kapatƒ±ldƒ±");
        process.exit(0);
    });
});

process.on("uncaughtException", (err) => {
    console.error("‚ùå Uncaught Exception:", err);
    process.exit(1);
});

process.on("unhandledRejection", (reason, promise) => {
    console.error("‚ùå Unhandled Rejection at:", promise, "reason:", reason);
    process.exit(1);
});

module.exports = server;
